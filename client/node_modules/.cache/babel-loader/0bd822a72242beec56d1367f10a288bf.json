{"ast":null,"code":"var RFC3986 = require('./rfc3986');\n\nvar internals = {\n  Ip: {\n    cidrs: {\n      required: '\\\\/(?:' + RFC3986.cidr + ')',\n      optional: '(?:\\\\/(?:' + RFC3986.cidr + '))?',\n      forbidden: ''\n    },\n    versions: {\n      ipv4: RFC3986.IPv4address,\n      ipv6: RFC3986.IPv6address,\n      ipvfuture: RFC3986.IPvFuture\n    }\n  }\n};\n\ninternals.Ip.createIpRegex = function (versions, cidr) {\n  var regex;\n\n  for (var i = 0, il = versions.length; i < il; ++i) {\n    var version = versions[i];\n\n    if (!regex) {\n      regex = '^(?:' + internals.Ip.versions[version];\n    }\n\n    regex += '|' + internals.Ip.versions[version];\n  }\n\n  return new RegExp(regex + ')' + internals.Ip.cidrs[cidr] + '$');\n};\n\nmodule.exports = internals.Ip;","map":null,"metadata":{},"sourceType":"script"}